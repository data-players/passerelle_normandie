import e from"jwt-decode";import t from"url-join";import*as r from"react";import n,{useState as a,useEffect as o,useCallback as i,useMemo as c,forwardRef as s}from"react";import{useTranslate as u,useGetList as l,useDataProvider as m,Loading as d,Error as f,usePermissionsOptimized as p,useAuthProvider as h,Button as v,ListButton as g,ShowButton as b,useRecordContext as y,DeleteButton as _,Toolbar as w,SaveButton as E,useGetIdentity as j,useNotify as O,useRedirect as k,Edit as P,EditButton as x,Show as C,useLogin as A,Notification as S,useSafeSetState as I,LoginForm as R,useLogout as T,Resource as N,UserMenu as U,MenuItemLink as z,useGetPermissions as L}from"react-admin";import{TopToolbar as W,List as V,ListActions as M}from"@semapps/archipelago-layout";import F from"@material-ui/icons/Share";import{makeStyles as B,TextField as D,List as q,ListItem as G,ListItemAvatar as $,Avatar as H,ListItemText as J,ListItemSecondaryAction as K,IconButton as Q,Menu as X,MenuItem as Y,ListItemIcon as Z,Dialog as ee,DialogTitle as te,DialogContent as re,DialogActions as ne,Card as ae,Typography as oe,CardActions as ie,Button as ce,CircularProgress as se,createMuiTheme as ue,ThemeProvider as le}from"@material-ui/core";import me from"@material-ui/lab/Autocomplete";import de from"@material-ui/icons/Person";import fe from"@material-ui/icons/Edit";import pe from"@material-ui/icons/Check";import he from"@material-ui/icons/Public";import ve from"@material-ui/icons/VpnLock";import ge from"@material-ui/icons/Group";import{useLocation as be,useHistory as ye,Redirect as _e,Link as we}from"react-router-dom";import{ThemeProvider as Ee}from"@material-ui/styles";import{makeStyles as je,createMuiTheme as Oe}from"@material-ui/core/styles";import ke from"@material-ui/icons/Lock";import Pe from"prop-types";import xe from"classnames";import{Form as Ce,Field as Ae}from"react-final-form";import Se from"@material-ui/core/MenuItem";import Ie from"@material-ui/icons/PowerSettingsNew";import Re from"@material-ui/icons/AccountCircle";function Te(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,a)}function Ne(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Te(o,n,a,i,c,"next",e)}function c(e){Te(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ze(){return(ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){Ue(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ve(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||Be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(e){return function(e){if(Array.isArray(e))return De(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){if(e){if("string"==typeof e)return De(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(e,t):void 0}}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qe,Ge,$e=function(e){return e?Array.isArray(e)?e:[e]:void 0},He=function(e,r){return t(e,r.replace(e,"_acl/"))},Je=function(e){return{"@base":e,acl:"http://www.w3.org/ns/auth/acl#",foaf:"http://xmlns.com/foaf/0.1/","acl:agent":{"@type":"@id"},"acl:agentGroup":{"@type":"@id"},"acl:agentClass":{"@type":"@id"},"acl:mode":{"@type":"@id"},"acl:accessTo":{"@type":"@id"}}},Ke=function(t){var r,n,a,o,i,c,s,u=t.middlewareUri,l=t.allowAnonymous,m=void 0===l||l,d=t.localAccounts,f=void 0!==d&&d,p=t.checkUser,h=t.httpClient,v=t.checkPermissions,g=t.resources;return{login:(s=Ne(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URL(window.location.href),!f){e.next=17;break}return n=t.username,a=t.password,e.prev=3,e.next=6,h("".concat(u,"auth"),{method:"POST",body:JSON.stringify({email:n.trim(),password:a.trim()}),headers:new Headers({"Content-Type":"application/json"})});case 6:o=e.sent,i=o.json,c=i.token,localStorage.setItem("token",c),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(3),new Error("ra.auth.sign_in_error");case 15:e.next=18;break;case 17:window.location.href="".concat(u,"auth?redirectUrl=")+encodeURIComponent(r.origin+"/login?login=true");case 18:case"end":return e.stop()}}),e,null,[[3,12]])}))),function(e){return s.apply(this,arguments)}),signup:(c=Ne(regeneratorRuntime.mark((function t(r){var n,a,o,i,c,s,l,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!f){t.next=22;break}return n=r.email,a=r.password,o=Ve(r,["email","password"]),t.prev=2,t.next=5,h("".concat(u,"auth/signup"),{method:"POST",body:JSON.stringify(We({email:n.trim(),password:a.trim()},o)),headers:new Headers({"Content-Type":"application/json"})});case 5:return i=t.sent,c=i.json,s=c.token,localStorage.setItem("token",s),l=e(s),m=l.webId,t.abrupt("return",m);case 13:if(t.prev=13,t.t0=t.catch(2),"email.already.exists"!==t.t0.message){t.next=19;break}throw new Error("auth.message.user_email_exist");case 19:throw new Error(t.t0.message||"ra.auth.sign_in_error");case 20:t.next=23;break;case 22:window.location.href="".concat(u,"auth?redirectUrl=")+encodeURIComponent(url.origin+"/login?login=true");case 23:case"end":return t.stop()}}),t,null,[[2,13]])}))),function(e){return c.apply(this,arguments)}),logout:(i=Ne(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("token"),f||(t=new URL(window.location.href),window.location.href=m?"".concat(u,"auth/logout?redirectUrl=")+encodeURIComponent(t.origin+"/login?logout=true"):"".concat(u,"auth/logout?redirectUrl=")+encodeURIComponent(t.origin+"/login")),e.abrupt("return","/");case 3:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),checkAuth:(o=Ne(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")||m){e.next=3;break}throw new Error;case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),checkUser:function(e){return!p||p(e)},checkError:function(e){return Promise.resolve()},getPermissions:(a=Ne(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return",!0);case 2:return r=g[t]?g[t].containerUri:t,n=He(u,r),e.next=6,h(n);case 6:return a=e.sent,o=a.json,e.abrupt("return",o["@graph"]);case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),addPermission:(n=Ne(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=g[t]?g[t].containerUri:t,c=He(u,i),Ue(o={"@id":"#"+a.replace("acl:",""),"@type":"acl:Authorization"},n,r),Ue(o,"acl:accessTo",i),Ue(o,"acl:mode",a),s=o,e.next=5,h(c,{method:"PATCH",body:JSON.stringify({"@context":Je(c),"@graph":[s]})});case 5:case"end":return e.stop()}}),e)}))),function(e,t,r,a){return n.apply(this,arguments)}),removePermission:(r=Ne(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=g[t]?g[t].containerUri:t,i=He(u,o),e.next=4,h(i);case 4:return c=e.sent,s=c.json,l=s["@graph"].filter((function(e){return!e["@id"].includes("#Default")})).map((function(e){var t=$e(e["acl:mode"]),o=$e(e[n]);return a&&t.includes(a)&&o&&o.includes(r)&&(o=o.filter((function(e){return e!==r}))),We(We({},e),{},Ue({},n,o))})),e.next=9,h(i,{method:"PUT",body:JSON.stringify({"@context":Je(i),"@graph":l})});case 9:case"end":return e.stop()}}),e)}))),function(e,t,n,a){return r.apply(this,arguments)}),getIdentity:function(){var t=localStorage.getItem("token");if(t){var r=e(t);return{id:r.webId,fullName:r.name||r["foaf:name"]}}}}},Qe="acl:agentClass",Xe=["acl:Append","acl:Write","acl:Control"],Ye=["acl:Append","acl:Write","acl:Control"],Ze=["acl:Write","acl:Control"],et=["acl:Control"],tt={show:["acl:Read","acl:Append","acl:Write","acl:Control"],list:["acl:Read","acl:Append","acl:Write","acl:Control"],create:Xe,edit:Ye,delete:Ze,control:et},rt={show:"auth.message.resource_show_forbidden",edit:"auth.message.resource_edit_forbidden",delete:"auth.message.resource_delete_forbidden",control:"auth.message.resource_control_forbidden",list:"auth.message.container_list_forbidden",create:"auth.message.container_create_forbidden"},nt=(Ue(qe={},"acl:Read","auth.right.resource.read"),Ue(qe,"acl:Append","auth.right.resource.append"),Ue(qe,"acl:Write","auth.right.resource.write"),Ue(qe,"acl:Control","auth.right.resource.control"),qe),at=(Ue(Ge={},"acl:Read","auth.right.container.read"),Ue(Ge,"acl:Write","auth.right.container.write"),Ue(Ge,"acl:Control","auth.right.container.control"),Ge),ot=B((function(){return{list:{padding:0,width:"100%"},option:{padding:0}}})),it=function(e){var t=e.agents,r=e.addPermission,i=ot(),c=u(),s=Me(a(null),2),m=s[0],d=s[1],f=Me(a(""),2),p=f[0],h=f[1],v=Me(a([]),2),g=v[0],b=v[1],y=l("Person",{page:1,perPage:100},{field:"pair:label",order:"ASC"},{q:p},{enabled:p.length>0}),_=y.ids,w=y.data;return o((function(){b(_.length>0?Object.values(w):[])}),[_,w]),n.createElement(me,{classes:{option:i.option},getOptionLabel:function(e){return e["pair:label"]},filterOptions:function(e){return e.filter((function(e){return!Object.keys(t).includes(e.id)}))},options:g,noOptionsText:c("ra.navigation.no_results"),autoComplete:!0,blurOnSelect:!0,clearOnBlur:!0,disableClearable:!0,value:m,onChange:function(e,t){r(t.id||t["@id"],"acl:agent","acl:Read"),d(null),h(""),b([])},onInputChange:function(e,t){h(t)},renderInput:function(e){return n.createElement(D,ze({},e,{label:c("auth.input.agent_select"),variant:"filled",margin:"dense",fullWidth:!0}))},renderOption:function(e){return n.createElement(q,{dense:!0,className:i.list},n.createElement(G,{button:!0},n.createElement($,null,n.createElement(H,{src:e.image},n.createElement(de,null))),n.createElement(J,{primary:e["pair:label"]})))}})},ct=function(e){var t=e.agent;switch(t.predicate){case Qe:return"foaf:Agent"===t.id?n.createElement(he,null):n.createElement(ve,null);case"acl:agent":return n.createElement(de,null);case"acl:agentGroup":return n.createElement(ge,null);default:throw new Error("Unknown agent predicate: "+t.predicate)}},st=B((function(){return{listItem:{paddingLeft:4,paddingRight:36},primaryText:{width:"30%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},secondaryText:{textAlign:"center",width:"60%",fontStyle:"italic",color:"grey"}}})),ut=function(e){var t=e.isContainer,r=e.agent,i=e.addPermission,c=e.removePermission,s=st(),l=u(),p=m(),h=Me(n.useState(null),2),v=h[0],g=h[1],b=Me(a(),2),y=b[0],_=b[1],w=Me(a(!0),2),E=w[0],j=w[1],O=Me(a(),2),k=O[0],P=O[1];if(o((function(){"acl:agent"===r.predicate?p.getOne("Person",{id:r.id}).then((function(e){var t=e.data;_(t),j(!1)})).catch((function(e){P(e),j(!1)})):j(!1)}),[r.id,r.predicate]),"acl:agentGroup"===r.predicate)return null;var x=function(){return g(null)},C=t?at:nt;return E?n.createElement(d,null):k?n.createElement(f,null):n.createElement(G,{className:s.listItem},n.createElement($,null,n.createElement(H,{src:null==y?void 0:y.image},n.createElement(ct,{agent:r}))),n.createElement(J,{className:s.primaryText,primary:y?y["pair:label"]:l("foaf:Agent"===r.id?"auth.agent.anonymous":"auth.agent.authenticated")}),n.createElement(J,{className:s.secondaryText,primary:r.permissions&&r.permissions.map((function(e){return l(C[e])})).join(", ")}),n.createElement(K,null,n.createElement(Q,{onClick:function(e){return g(e.currentTarget)}},n.createElement(fe,null)),n.createElement(X,{anchorEl:v,keepMounted:!0,open:Boolean(v),onClose:x},Object.entries(C).map((function(e){var t=Me(e,2),a=t[0],o=t[1],s=r.permissions&&r.permissions.includes(a);return n.createElement(Y,{key:a,onClick:function(){s?c(r.id,r.predicate,a):i(r.id,r.predicate,a),x()}},n.createElement(Z,null,s?n.createElement(pe,null):null),n.createElement(J,{primary:l(o)}))})))))},lt=B((function(e){return{list:{width:"100%",maxWidth:"100%",backgroundColor:e.palette.background.paper}}})),mt=function(e){var t=e.isContainer,r=e.agents,a=e.addPermission,o=e.removePermission,i=lt();return n.createElement(q,{dense:!0,className:i.list},Object.entries(r).map((function(e){var r=Me(e,2),i=r[0],c=r[1];return n.createElement(ut,{key:i,isContainer:t,agent:c,addPermission:a,removePermission:o})})))},dt=function(e){var t=p(e).permissions,r=h(),n=Me(a({}),2),c=n[0],s=n[1];o((function(){var e,r=(Ue(e={},"foaf:Agent",{id:"foaf:Agent",predicate:Qe,permissions:[]}),Ue(e,"acl:AuthenticatedAgent",{id:"acl:AuthenticatedAgent",predicate:Qe,permissions:[]}),e),n=function(e,t,n){r[e]?r[e].permissions.push(n):r[e]={id:e,predicate:t,permissions:[n]}};if(t){var a,o=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=Be(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}(t);try{var i=function(){var e=a.value;e[Qe]&&$e(e[Qe]).forEach((function(t){return n(t,Qe,e["acl:mode"])})),e["acl:agent"]&&$e(e["acl:agent"]).forEach((function(t){return n(t,"acl:agent",e["acl:mode"])})),e["acl:agentGroup"]&&$e(e["acl:agentGroup"]).forEach((function(t){return n(t,"acl:agentGroup",e["acl:mode"])}))};for(o.s();!(a=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}s(r)}}),[t]);var u=i((function(t,n,a){var o,i=We({},c);s(We(We({},c),{},Ue({},t,{id:t,predicate:n,permissions:c[t]?[].concat(Fe(null===(o=c[t])||void 0===o?void 0:o.permissions),[a]):[a]}))),r.addPermission(e,t,n,a).catch((function(e){s(i)}))}),[c,s,e,r]),l=i((function(t,n,a){var o=We({},c);s(Object.fromEntries(Object.entries(c).map((function(e){var r=Me(e,2),n=r[0],o=r[1];return o.id===t&&(o.permissions=o.permissions.filter((function(e){return e!==a}))),[n,o]})).filter((function(e){var t=Me(e,2);t[0];var r=t[1];return r.predicate===Qe||r.permissions.length>0})))),r.removePermission(e,t,n,a).catch((function(e){s(o)}))}),[c,s,e,r]);return{agents:c,addPermission:u,removePermission:l}},ft=B((function(){return{title:{paddingBottom:8},actions:{padding:15},addForm:{paddingTop:0},listForm:{paddingTop:0,paddingBottom:0,paddingRight:0,maxHeight:210}}})),pt=function(e){var t=e.open,r=e.onClose,a=e.resourceId,o=e.isContainer,i=ft(),c=u(),s=dt(a),l=s.agents,m=s.addPermission,d=s.removePermission;return n.createElement(ee,{fullWidth:!0,open:t,onClose:r},n.createElement(te,{className:i.title},c(o?"auth.dialog.container_permissions":"auth.dialog.resource_permissions")),n.createElement(re,{className:i.addForm},n.createElement(it,{agents:l,addPermission:m})),n.createElement(re,{className:i.listForm},n.createElement(mt,{isContainer:o,agents:l,addPermission:m,removePermission:d})),n.createElement(ne,{className:i.actions},n.createElement(v,{label:"ra.action.close",variant:"text",onClick:r})))},ht=function(e){var t=e.record,r=e.resource,o=Me(a(!1),2),i=o[0],c=o[1],s=!!r?r:t.id||t["@id"];return n.createElement(n.Fragment,null,n.createElement(v,{label:"auth.action.permissions",onClick:function(){return c(!0)}},n.createElement(F,null)),n.createElement(pt,{resourceId:s,isContainer:!!r,open:i,onClose:function(){return c(!1)}}))},vt=function(e){var t=e.basePath,r=e.className,a=e.data,o=e.hasList,i=e.hasShow,c=e.hasControl,s=Ve(e,["basePath","className","data","hasList","hasShow","hasControl"]);return n.createElement(W,ze({className:r},s),o&&n.createElement(g,{basePath:t,record:a}),i&&n.createElement(b,{basePath:t,record:a}),a&&c&&n.createElement(ht,{basePath:t,record:a}))},gt=function(e){var t=y(),r=p(t.id).permissions;return r&&r.some((function(e){return Ze.includes(e["acl:mode"])}))?n.createElement(_,e):null},bt=B((function(){return{toolbar:{flex:1,display:"flex",justifyContent:"space-between"}}})),yt=function(e){var t=bt();return n.createElement(w,ze({},e,{className:t.toolbar}),n.createElement(E,null),n.createElement(gt,{undoable:!1}),"}")},_t=function(){var e=j(),t=e.identity,r=e.loading,n=O(),a=k(),i=be();return o((function(){r||null!=t&&t.id||(n("ra.auth.auth_check_error","error"),a("/login?redirect="+encodeURIComponent(i.pathname)))}),[r,t,a,n,i]),{identity:t,loading:r}},wt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",n=_t(),a=n.identity,i=p(e),c=i.permissions,s=O(),u=k();return o((function(){null!=a&&a.id&&c&&!c.some((function(e){return tt[t].includes(e["acl:mode"])}))&&(s(rt[t],"error"),u(r))}),[c,a,u,s]),c},Et=function(e){var t=wt(e.id,"edit");return n.createElement(P,ze({actions:n.createElement(vt,{hasControl:!!t&&t.some((function(e){return et.includes(e["acl:mode"])}))})},e,{permissions:t}),n.cloneElement(e.children,We({toolbar:n.createElement(yt,null)},e.children.props)))},jt=function(e){var t=e.actions,r=e.resource,a=e.hasCreate,o=Ve(e,["actions","resource","hasCreate"]),i=p(r).permissions;return n.createElement(V,ze({},o,{resource:r,hasCreate:a&&!!i&&i.some((function(e){return Xe.includes(e["acl:mode"])})),actions:t&&i&&i.some((function(e){return et.includes(e["acl:mode"])}))?n.cloneElement(t,{bulkActions:n.createElement(ht,null)}):t}))};jt.defaultProps={actions:n.createElement(M,null)};var Ot=function(e){var t=e.basePath,r=e.className,a=e.data,o=e.hasList,i=e.hasEdit,c=e.hasControl,s=Ve(e,["basePath","className","data","hasList","hasEdit","hasControl"]);return n.createElement(W,ze({className:r},s),o&&n.createElement(g,{basePath:t,record:a}),i&&n.createElement(x,{basePath:t,record:a}),a&&c&&n.createElement(ht,{basePath:t,record:a}))},kt=function(e){var t=p(e.id).permissions;return n.createElement(C,ze({actions:n.createElement(Ot,{hasControl:!!t&&t.some((function(e){return et.includes(e["acl:mode"])}))})},e,{permissions:t,hasEdit:e.hasEdit&&!!t&&t.some((function(e){return Ye.includes(e["acl:mode"])}))}))},Pt=je((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",alignItems:"center",justifyContent:"flex-start",backgroundColor:e.palette.grey[300]},text:{maxWidth:300,textAlign:"center",padding:"4px 8px 8px"},card:{minWidth:300,marginTop:"6em"},lockIconAvatar:{margin:"1em",display:"flex",justifyContent:"center"},lockIcon:{backgroundColor:e.palette.grey[500]}}})),xt=function(t){var r=t.theme,a=t.history,i=t.location,c=t.buttons,s=t.userResource,u=t.text,l=Pt(),d=O(),f=A(),p=m(),v=h();return o((function(){Ne(regeneratorRuntime.mark((function t(){var r,n,o,c,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=new URLSearchParams(i.search)).has("login")){t.next=14;break}if(!r.has("error")){t.next=6;break}"registration.not-allowed"===r.get("error")?d("auth.message.user_email_not_found","error"):d("auth.message.bad_request","error",{error:r.get("error")}),t.next=14;break;case 6:if(!r.has("token")){t.next=14;break}return n=r.get("token"),o=e(n),c=o.webId,t.next=11,p.getOne("Person",{id:c});case 11:u=t.sent,l=u.data,v.checkUser(l)?(localStorage.setItem("token",n),r.has("new")&&"true"===r.get("new")?(d("auth.message.new_user_created","info"),a.push("/"+s+"/"+encodeURIComponent(c)+"/edit")):(d("auth.message.user_connected","info"),a.push("/"))):(d("auth.message.user_not_allowed_to_login","error"),a.replace("/login"));case 14:r.has("logout")&&(localStorage.removeItem("token"),d("auth.message.user_disconnected","info"),a.push("/"));case 15:case"end":return t.stop()}}),t)})))()}),[i.search]),n.createElement(Ee,{theme:Oe(r)},n.createElement("div",{className:l.main},n.createElement(ae,{className:l.card},n.createElement("div",{className:l.lockIconAvatar},n.createElement(H,{className:l.lockIcon},n.createElement(ke,null))),u&&n.createElement(oe,{variant:"body2",className:l.text},u),c&&c.map((function(e,t){return n.createElement(ie,{key:t},n.cloneElement(e,{fullWidth:!0,variant:"outlined",type:"submit",onClick:function(){return f({},"/login")}}))})))),n.createElement(S,null))};xt.defaultProps={buttons:[n.createElement(ce,{startIcon:n.createElement(H,{src:"/lescommuns.jpg"})},"Les Communs")],userResource:"Person"};var Ct=function(){var e=h();return i((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.signup(t)}),[e])},At=B((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}})),St=function(e){var t=e.meta,n=t.touched,a=t.error,o=e.input,i=Ve(e,["meta","input"]);return r.createElement(D,ze({error:!(!n||!a),helperText:n&&a},o,i,{fullWidth:!0}))},It=function(e){var t=e.redirectTo,n=e.delayBeforeRedirect,a=Me(I(!1),2),o=a[0],i=a[1],c=Ct(),s=u(),l=O(),m=At(),d=be(),f=ye(),p=new URLSearchParams(d.search);return r.createElement(Ce,{onSubmit:function(e){i(!0),c(e).then((function(e){n?setTimeout((function(){f.push(t||"/Person/"+encodeURIComponent(e)+"/edit"),i(!1)}),n):(f.push(t||"/Person/"+encodeURIComponent(e)+"/edit"),i(!1)),l("auth.message.new_user_created","info")})).catch((function(e){i(!1),l("string"==typeof e?e:void 0!==e&&e.message?e.message:"ra.auth.sign_in_error","warning",{_:"string"==typeof e?e:e&&e.message?e.message:void 0})}))},validate:function(e){var t={email:void 0,password:void 0};return e.email||(t.email=s("ra.validation.required")),e.password||(t.password=s("ra.validation.required")),t},initialValues:{name:p.get("name"),email:p.get("email")},render:function(e){var t=e.handleSubmit;return r.createElement("form",{onSubmit:t,noValidate:!0},r.createElement("div",{className:m.form},r.createElement("div",{className:m.input},r.createElement(Ae,{autoFocus:!0,id:"name",name:"name",component:St,label:s("auth.input.name"),disabled:o})),r.createElement("div",{className:m.input},r.createElement(Ae,{id:"email",name:"email",component:St,label:s("auth.input.email"),disabled:o||p.has("email")&&p.has("force-email")})),r.createElement("div",{className:m.input},r.createElement(Ae,{id:"password",name:"password",component:St,label:s("ra.auth.password"),type:"password",disabled:o}))),r.createElement(ie,null,r.createElement(ce,{variant:"contained",type:"submit",color:"primary",disabled:o,className:m.button},o&&r.createElement(se,{className:m.icon,size:18,thickness:2}),s("auth.action.signup"))))}})};It.propTypes={redirectTo:Pe.string};var Rt=B((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",height:"1px",alignItems:"center",justifyContent:"flex-start",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"radial-gradient(circle at 50% 14em, #313264 0%, #00023b 60%, #00023b 100%)"},card:{minWidth:300,marginTop:"6em"},avatar:{margin:"1em",display:"flex",justifyContent:"center"},icon:{backgroundColor:e.palette.secondary[500]},switch:{margin:"1em",display:"flex",justifyContent:"center"}}})),Tt=function(e){var t=e.theme;e.title,e.classes;var r=e.className,a=Ve(e,["theme","title","classes","className"]),o=Rt(e),i=be(),s=c((function(){return ue(t)}),[t]),u=new URLSearchParams(i.search),l=u.has("signup"),m=u.get("redirect"),d=j().identity;return null!=d&&d.id?n.createElement(_e,{to:m||"/"}):n.createElement(le,{theme:s},n.createElement("div",ze({className:xe(o.main,r)},a),n.createElement(ae,{className:o.card},n.createElement("div",{className:o.avatar},n.createElement(H,{className:o.icon},n.createElement(ke,null))),l?n.createElement(It,{redirectTo:m,delayBeforeRedirect:3e3}):n.createElement(R,{redirectTo:m}),n.createElement("div",{className:o.switch},l?n.createElement(we,{to:"/login"},n.createElement(oe,{variant:"body2"},"Se connecter avec un compte")):n.createElement(we,{to:"/login?signup=true"},n.createElement(oe,{variant:"body2"},"Créer un nouveau compte")))),n.createElement(S,null)))};Tt.propTypes={children:Pe.node,classes:Pe.object,className:Pe.string,theme:Pe.object};var Nt=s((function(e,t){var r=T();return n.createElement(Se,{onClick:function(){return r()},ref:t},n.createElement(Ie,null),"   Se déconnecter")})),Ut=function(e){var t=e.name,r=e.create,a=Ve(e,["name","create"]),o=p(t).permissions;return n.createElement(N,ze({},a,{name:t,create:o&&o.some((function(e){return Xe.includes(e["acl:mode"])}))?r:void 0}))},zt=s((function(e,t){var r=e.onClick,a=e.webId;return n.createElement(z,{ref:t,to:"/Person/".concat(encodeURIComponent(a),"/show"),primaryText:"Voir mon profil",leftIcon:n.createElement(Re,null),onClick:r})})),Lt=s((function(e,t){var r=e.onClick,a=e.webId;return n.createElement(z,{ref:t,to:"/Person/".concat(encodeURIComponent(a),"/edit"),primaryText:"Editer mon profil",leftIcon:n.createElement(fe,null),onClick:r})})),Wt=s((function(e,t){var r=e.onClick;return n.createElement(z,{ref:t,to:"/login",primaryText:"Se connecter",onClick:r})})),Vt=s((function(e,t){var r=e.onClick;return n.createElement(z,{ref:t,to:"/login?signup=true",primaryText:"Créer un compte",onClick:r})})),Mt=function(e){var t=e.logout,r=Ve(e,["logout"]),a=j().identity;return n.createElement(U,r,a&&""!==a.id?[n.createElement(zt,{webId:a.id,key:"view"}),n.createElement(Lt,{webId:a.id,key:"edit"}),n.cloneElement(t,{key:"logout"})]:[n.createElement(Vt,{key:"signup"}),n.createElement(Wt,{key:"login"})])};var Ft=function(){this.__data__=[],this.size=0};var Bt=function(e,t){return e===t||e!=e&&t!=t};var Dt=function(e,t){for(var r=e.length;r--;)if(Bt(e[r][0],t))return r;return-1},qt=Array.prototype.splice;var Gt=function(e){var t=this.__data__,r=Dt(t,e);return!(r<0)&&(r==t.length-1?t.pop():qt.call(t,r,1),--this.size,!0)};var $t=function(e){var t=this.__data__,r=Dt(t,e);return r<0?void 0:t[r][1]};var Ht=function(e){return Dt(this.__data__,e)>-1};var Jt=function(e,t){var r=this.__data__,n=Dt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Kt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Kt.prototype.clear=Ft,Kt.prototype.delete=Gt,Kt.prototype.get=$t,Kt.prototype.has=Ht,Kt.prototype.set=Jt;var Qt=Kt;var Xt=function(){this.__data__=new Qt,this.size=0};var Yt=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var Zt=function(e){return this.__data__.get(e)};var er=function(e){return this.__data__.has(e)},tr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function rr(e,t){return e(t={exports:{}},t.exports),t.exports}var nr="object"==typeof tr&&tr&&tr.Object===Object&&tr,ar="object"==typeof self&&self&&self.Object===Object&&self,or=nr||ar||Function("return this")(),ir=or.Symbol,cr=Object.prototype,sr=cr.hasOwnProperty,ur=cr.toString,lr=ir?ir.toStringTag:void 0;var mr=function(e){var t=sr.call(e,lr),r=e[lr];try{e[lr]=void 0;var n=!0}catch(e){}var a=ur.call(e);return n&&(t?e[lr]=r:delete e[lr]),a},dr=Object.prototype.toString;var fr=function(e){return dr.call(e)},pr=ir?ir.toStringTag:void 0;var hr=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":pr&&pr in Object(e)?mr(e):fr(e)};var vr=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var gr,br=function(e){if(!vr(e))return!1;var t=hr(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},yr=or["__core-js_shared__"],_r=(gr=/[^.]+$/.exec(yr&&yr.keys&&yr.keys.IE_PROTO||""))?"Symbol(src)_1."+gr:"";var wr=function(e){return!!_r&&_r in e},Er=Function.prototype.toString;var jr=function(e){if(null!=e){try{return Er.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Or=/^\[object .+?Constructor\]$/,kr=Function.prototype,Pr=Object.prototype,xr=kr.toString,Cr=Pr.hasOwnProperty,Ar=RegExp("^"+xr.call(Cr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Sr=function(e){return!(!vr(e)||wr(e))&&(br(e)?Ar:Or).test(jr(e))};var Ir=function(e,t){return null==e?void 0:e[t]};var Rr=function(e,t){var r=Ir(e,t);return Sr(r)?r:void 0},Tr=Rr(or,"Map"),Nr=Rr(Object,"create");var Ur=function(){this.__data__=Nr?Nr(null):{},this.size=0};var zr=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Lr=Object.prototype.hasOwnProperty;var Wr=function(e){var t=this.__data__;if(Nr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Lr.call(t,e)?t[e]:void 0},Vr=Object.prototype.hasOwnProperty;var Mr=function(e){var t=this.__data__;return Nr?void 0!==t[e]:Vr.call(t,e)};var Fr=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Nr&&void 0===t?"__lodash_hash_undefined__":t,this};function Br(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Br.prototype.clear=Ur,Br.prototype.delete=zr,Br.prototype.get=Wr,Br.prototype.has=Mr,Br.prototype.set=Fr;var Dr=Br;var qr=function(){this.size=0,this.__data__={hash:new Dr,map:new(Tr||Qt),string:new Dr}};var Gr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var $r=function(e,t){var r=e.__data__;return Gr(t)?r["string"==typeof t?"string":"hash"]:r.map};var Hr=function(e){var t=$r(this,e).delete(e);return this.size-=t?1:0,t};var Jr=function(e){return $r(this,e).get(e)};var Kr=function(e){return $r(this,e).has(e)};var Qr=function(e,t){var r=$r(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Xr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xr.prototype.clear=qr,Xr.prototype.delete=Hr,Xr.prototype.get=Jr,Xr.prototype.has=Kr,Xr.prototype.set=Qr;var Yr=Xr;var Zr=function(e,t){var r=this.__data__;if(r instanceof Qt){var n=r.__data__;if(!Tr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Yr(n)}return r.set(e,t),this.size=r.size,this};function en(e){var t=this.__data__=new Qt(e);this.size=t.size}en.prototype.clear=Xt,en.prototype.delete=Yt,en.prototype.get=Zt,en.prototype.has=er,en.prototype.set=Zr;var tn=en;var rn=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var nn=function(e){return this.__data__.has(e)};function an(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Yr;++t<r;)this.add(e[t])}an.prototype.add=an.prototype.push=rn,an.prototype.has=nn;var on=an;var cn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var sn=function(e,t){return e.has(t)};var un=function(e,t,r,n,a,o){var i=1&r,c=e.length,s=t.length;if(c!=s&&!(i&&s>c))return!1;var u=o.get(e),l=o.get(t);if(u&&l)return u==t&&l==e;var m=-1,d=!0,f=2&r?new on:void 0;for(o.set(e,t),o.set(t,e);++m<c;){var p=e[m],h=t[m];if(n)var v=i?n(h,p,m,t,e,o):n(p,h,m,e,t,o);if(void 0!==v){if(v)continue;d=!1;break}if(f){if(!cn(t,(function(e,t){if(!sn(f,t)&&(p===e||a(p,e,r,n,o)))return f.push(t)}))){d=!1;break}}else if(p!==h&&!a(p,h,r,n,o)){d=!1;break}}return o.delete(e),o.delete(t),d},ln=or.Uint8Array;var mn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var dn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},fn=ir?ir.prototype:void 0,pn=fn?fn.valueOf:void 0;var hn=function(e,t,r,n,a,o,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new ln(e),new ln(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Bt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=mn;case"[object Set]":var s=1&n;if(c||(c=dn),e.size!=t.size&&!s)return!1;var u=i.get(e);if(u)return u==t;n|=2,i.set(e,t);var l=un(c(e),c(t),n,a,o,i);return i.delete(e),l;case"[object Symbol]":if(pn)return pn.call(e)==pn.call(t)}return!1};var vn=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},gn=Array.isArray;var bn=function(e,t,r){var n=t(e);return gn(e)?n:vn(n,r(e))};var yn=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o};var _n=function(){return[]},wn=Object.prototype.propertyIsEnumerable,En=Object.getOwnPropertySymbols,jn=En?function(e){return null==e?[]:(e=Object(e),yn(En(e),(function(t){return wn.call(e,t)})))}:_n;var On=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var kn=function(e){return null!=e&&"object"==typeof e};var Pn=function(e){return kn(e)&&"[object Arguments]"==hr(e)},xn=Object.prototype,Cn=xn.hasOwnProperty,An=xn.propertyIsEnumerable,Sn=Pn(function(){return arguments}())?Pn:function(e){return kn(e)&&Cn.call(e,"callee")&&!An.call(e,"callee")};var In=function(){return!1},Rn=rr((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?or.Buffer:void 0,o=(a?a.isBuffer:void 0)||In;e.exports=o})),Tn=/^(?:0|[1-9]\d*)$/;var Nn=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Tn.test(e))&&e>-1&&e%1==0&&e<t};var Un=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},zn={};zn["[object Float32Array]"]=zn["[object Float64Array]"]=zn["[object Int8Array]"]=zn["[object Int16Array]"]=zn["[object Int32Array]"]=zn["[object Uint8Array]"]=zn["[object Uint8ClampedArray]"]=zn["[object Uint16Array]"]=zn["[object Uint32Array]"]=!0,zn["[object Arguments]"]=zn["[object Array]"]=zn["[object ArrayBuffer]"]=zn["[object Boolean]"]=zn["[object DataView]"]=zn["[object Date]"]=zn["[object Error]"]=zn["[object Function]"]=zn["[object Map]"]=zn["[object Number]"]=zn["[object Object]"]=zn["[object RegExp]"]=zn["[object Set]"]=zn["[object String]"]=zn["[object WeakMap]"]=!1;var Ln=function(e){return kn(e)&&Un(e.length)&&!!zn[hr(e)]};var Wn=function(e){return function(t){return e(t)}},Vn=rr((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&nr.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o})),Mn=Vn&&Vn.isTypedArray,Fn=Mn?Wn(Mn):Ln,Bn=Object.prototype.hasOwnProperty;var Dn=function(e,t){var r=gn(e),n=!r&&Sn(e),a=!r&&!n&&Rn(e),o=!r&&!n&&!a&&Fn(e),i=r||n||a||o,c=i?On(e.length,String):[],s=c.length;for(var u in e)!t&&!Bn.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Nn(u,s))||c.push(u);return c},qn=Object.prototype;var Gn=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||qn)};var $n=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),Hn=Object.prototype.hasOwnProperty;var Jn=function(e){if(!Gn(e))return $n(e);var t=[];for(var r in Object(e))Hn.call(e,r)&&"constructor"!=r&&t.push(r);return t};var Kn=function(e){return null!=e&&Un(e.length)&&!br(e)};var Qn=function(e){return Kn(e)?Dn(e):Jn(e)};var Xn=function(e){return bn(e,Qn,jn)},Yn=Object.prototype.hasOwnProperty;var Zn=function(e,t,r,n,a,o){var i=1&r,c=Xn(e),s=c.length;if(s!=Xn(t).length&&!i)return!1;for(var u=s;u--;){var l=c[u];if(!(i?l in t:Yn.call(t,l)))return!1}var m=o.get(e),d=o.get(t);if(m&&d)return m==t&&d==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=i;++u<s;){var h=e[l=c[u]],v=t[l];if(n)var g=i?n(v,h,l,t,e,o):n(h,v,l,e,t,o);if(!(void 0===g?h===v||a(h,v,r,n,o):g)){f=!1;break}p||(p="constructor"==l)}if(f&&!p){var b=e.constructor,y=t.constructor;b==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(f=!1)}return o.delete(e),o.delete(t),f},ea=Rr(or,"DataView"),ta=Rr(or,"Promise"),ra=Rr(or,"Set"),na=Rr(or,"WeakMap"),aa=jr(ea),oa=jr(Tr),ia=jr(ta),ca=jr(ra),sa=jr(na),ua=hr;(ea&&"[object DataView]"!=ua(new ea(new ArrayBuffer(1)))||Tr&&"[object Map]"!=ua(new Tr)||ta&&"[object Promise]"!=ua(ta.resolve())||ra&&"[object Set]"!=ua(new ra)||na&&"[object WeakMap]"!=ua(new na))&&(ua=function(e){var t=hr(e),r="[object Object]"==t?e.constructor:void 0,n=r?jr(r):"";if(n)switch(n){case aa:return"[object DataView]";case oa:return"[object Map]";case ia:return"[object Promise]";case ca:return"[object Set]";case sa:return"[object WeakMap]"}return t});var la=ua,ma="[object Object]",da=Object.prototype.hasOwnProperty;var fa=function(e,t,r,n,a,o){var i=gn(e),c=gn(t),s=i?"[object Array]":la(e),u=c?"[object Array]":la(t),l=(s="[object Arguments]"==s?ma:s)==ma,m=(u="[object Arguments]"==u?ma:u)==ma,d=s==u;if(d&&Rn(e)){if(!Rn(t))return!1;i=!0,l=!1}if(d&&!l)return o||(o=new tn),i||Fn(e)?un(e,t,r,n,a,o):hn(e,t,s,r,n,a,o);if(!(1&r)){var f=l&&da.call(e,"__wrapped__"),p=m&&da.call(t,"__wrapped__");if(f||p){var h=f?e.value():e,v=p?t.value():t;return o||(o=new tn),a(h,v,r,n,o)}}return!!d&&(o||(o=new tn),Zn(e,t,r,n,a,o))};var pa=function e(t,r,n,a,o){return t===r||(null==t||null==r||!kn(t)&&!kn(r)?t!=t&&r!=r:fa(t,r,n,a,e,o))};var ha=function(e,t){return pa(e,t)},va={},ga={"{}":void 0},ba=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:va,t=JSON.stringify(e),r=I({permissions:ga[t]}),n=Me(r,2),a=n[0],c=n[1],s=L(),u=i((function(){return s(e).then((function(e){ha(e,a.permissions)||(ga[t]=e,c({permissions:e}))})).catch((function(e){c({error:e})}))}),[t,e,s]);return o((function(){u()}),[t]),We(We({},a),{},{refetch:u})},ya={auth:{dialog:{container_permissions:"Permissions sur le container",resource_permissions:"Permissions sur la resource"},action:{permissions:"Permissions",signup:"S'inscrire"},right:{resource:{read:"Lire",append:"Enrichir",write:"Modifier",control:"Administrer"},container:{read:"Lister",append:"Ajouter",write:"Ajouter",control:"Administrer"}},agent:{anonymous:"Tous les utilisateurs",authenticated:"Utilisateurs connectés"},input:{agent_select:"Ajouter un utilisateur...",name:"Prénom",email:"Adresse e-mail"},message:{resource_show_forbidden:"Vous n'avez pas la permission de voir cette ressource",resource_edit_forbidden:"Vous n'avez pas la permission d'éditer cette ressource",resource_delete_forbidden:"Vous n'avez pas la permission d'effacer cette ressource",resource_control_forbidden:"Vous n'avez pas la permission d'administrer cette ressource",container_create_forbidden:"Vous n'avez pas la permission de créer des ressources",container_list_forbidden:"Vous n'avez pas la permission de voir ces ressources",user_not_allowed_to_login:"Vous n'avez pas le droit de vous connecter avec ce compte",user_email_not_found:"Aucun compte trouvé avec cette adresse mail",user_email_exist:"Un compte existe déjà avec cette adresse mail",new_user_created:"Votre compte a été créé avec succès",user_connected:"Vous êtes maintenant connecté",user_disconnected:"Vous êtes maintenant déconnecté",bad_request:"Requête erronée (Message d'erreur renvoyé par le serveur: %{error})"}}};export{gt as DeleteButtonWithPermissions,vt as EditActions,yt as EditToolbarWithPermissions,Et as EditWithPermissions,jt as ListWithPermissions,Tt as LocalLoginPage,xt as LoginPage,Nt as LogoutButton,ht as PermissionsButton,Ut as ResourceWithPermissions,Ot as ShowActions,kt as ShowWithPermissions,xt as SsoLoginPage,Mt as UserMenu,Ke as authProvider,ya as frenchMessages,dt as useAgents,_t as useCheckAuthenticated,wt as useCheckPermissions,ba as usePermissionsWithRefetch,Ct as useSignup};
//# sourceMappingURL=index.es.js.map
